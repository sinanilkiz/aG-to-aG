#!/usr/bin/env python
from base import *

def _prefixed(level, message):
    now = time.strftime('%a, %d %b %Y %H:%M:%S', time.localtime())
    return "%s %-8s %-6d %s" % (now, level, os.getpid(), message)


aGalaxy_server = "172.30.60.21"
syslog.openlog("BGP-A10-Integration")

aG1 = aGserver(aGalaxy_server, "443", "admin", "a10")
#dst_entries_1 = aG1.get_dstentry_list().json()
#incidents1 = aG1.get_incident_list().json()
mit_temps1 = aG1.get_mitigation_template_list().json()

mitigation_template_list_1 = {"mitigation_template_list":[{"id":"59a87d3c-3dc8-4ad3-9345-deec42988533","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":False,"other_deny":"","tcp":101,"udp":102,"icmp":103,"other":104,"template":"default_icmp","templatev6":""},"port_wildcards_check":{"tcp":"disable","udp":"disable"},"port_countermeasures":{"ports":[{"port_num":80,"template":{"tcp":"default_tcp_1","udp":"","dns":"","http":"default_http_1","ssl_l4":""},"protocol":"http","glid":""},{"port_num":53,"template":{"tcp":"","udp":"default_udp_1","dns":"default_dns_1","http":"","ssl_l4":""},"protocol":"dns-udp","glid":""},{"port_num":443,"template":{"tcp":"default_tcp_1","udp":"","dns":"","http":"","ssl_l4":"default_ssl"},"protocol":"ssl-l4","glid":""}],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"default_per_source","dns":"","ssl_l4":"default_per_source_ssl"},"ip_proto":{"ports":[{"port_num":4,"template":{"other":""},"glid":""},{"port_num":51,"template":{"other":""},"glid":""},{"port_num":47,"template":{"other":""},"glid":""},{"port_num":41,"template":{"other":""},"glid":""},{"port_num":5,"template":{"other":""},"glid":""},{"port_num":50,"template":{"other":""},"glid":""}]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":104,"udp":104,"icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/59a87d3c-3dc8-4ad3-9345-deec42988533/?format=json","created":"2016-08-09T22:42:40Z","modified":"2016-08-17T16:09:07Z","name":"customer-1-mit-temp-1","note":"","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"},{"id":"ae1c22a5-e2d5-4860-968f-152dc183f62d","countermeasures":{"dst_rates":{"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":"","template":"","templatev6":""},"port_wildcards_check":{"tcp":"enable","udp":"enable"},"port_countermeasures":{"ports":[],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/ae1c22a5-e2d5-4860-968f-152dc183f62d/?format=json","created":"2016-05-25T14:33:54Z","modified":"2016-05-25T14:33:54Z","name":"Default","note":"","default_template":True,"domain_id":"","creating_user_id":""},{"id":"78b0a30d-15b8-44ed-83e7-81f674398549","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":"","other_deny":"","tcp":101,"udp":102,"icmp":103,"other":"","template":"default_icmp","templatev6":""},"port_wildcards_check":{"tcp":"disable","udp":"disable"},"port_countermeasures":{"ports":[{"port_num":53,"template":{"tcp":"","udp":"default_udp_1","dns":"default_dns_1","http":"","ssl_l4":""},"protocol":"dns-udp","glid":""},{"port_num":80,"template":{"tcp":"default_tcp_1","udp":"","dns":"","http":"default_http_1","ssl_l4":""},"protocol":"http","glid":""}],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[{"port_num":41,"template":{"other":""},"glid":""},{"port_num":47,"template":{"other":""},"glid":""},{"port_num":50,"template":{"other":""},"glid":""},{"port_num":5,"template":{"other":""},"glid":""},{"port_num":51,"template":{"other":""},"glid":""},{"port_num":4,"template":{"other":""},"glid":""}]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/78b0a30d-15b8-44ed-83e7-81f674398549/?format=json","created":"2016-08-10T19:29:56Z","modified":"2016-08-10T19:54:43Z","name":"mit-temp-2","note":"Default mitigation template for general objects","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"},{"id":"a26fe739-b8f2-48ff-b024-ccc727dd9eb9","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":"","other_deny":"","tcp":"","udp":"","icmp":"","other":"","template":"","templatev6":""},"port_wildcards_check":{"tcp":"enable","udp":"enable"},"port_countermeasures":{"ports":[],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/a26fe739-b8f2-48ff-b024-ccc727dd9eb9/?format=json","created":"2016-08-17T16:10:23Z","modified":"2016-08-17T16:10:23Z","name":"mit-temp-test-25-128","note":"","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"},{"id":"f3b4acd3-5035-4402-aee4-8219fb2406d9","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":"","other_deny":"","tcp":"","udp":"","icmp":"","other":"","template":"","templatev6":""},"port_wildcards_check":{"tcp":"enable","udp":"enable"},"port_countermeasures":{"ports":[],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/f3b4acd3-5035-4402-aee4-8219fb2406d9/?format=json","created":"2016-08-17T16:10:38Z","modified":"2016-08-17T16:10:38Z","name":"mit-temp-test-26-128","note":"","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"},{"id":"4175f769-8ec2-411f-957b-32c48d231b88","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":"","other_deny":"","tcp":"","udp":"","icmp":"","other":"","template":"","templatev6":""},"port_wildcards_check":{"tcp":"enable","udp":"enable"},"port_countermeasures":{"ports":[],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/4175f769-8ec2-411f-957b-32c48d231b88/?format=json","created":"2016-08-17T16:10:51Z","modified":"2016-08-17T16:10:51Z","name":"mit-temp-test-32-133","note":"","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"},{"id":"20601b92-c273-49ad-983f-757703348529","countermeasures":{"dst_rates":{"tcp_deny":"","udp_deny":"","icmp_deny":"","other_deny":"","tcp":"","udp":"","icmp":"","other":"","template":"","templatev6":""},"port_wildcards_check":{"tcp":"enable","udp":"enable"},"port_countermeasures":{"ports":[],"port_ranges":[]},"src_auth":{"tcp":"","udp":"","other":""},"app_countermeasures":{"http":"","dns":"","ssl_l4":""},"ip_proto":{"ports":[]},"src_policy":{"classlists":[],"tcp_deny":False,"udp_deny":False,"icmp_deny":False,"other_deny":False,"tcp":"","udp":"","icmp":"","other":""}},"url":"https://172.30.60.21/agapi/v1/ddos/template/mitigation/20601b92-c273-49ad-983f-757703348529/?format=json","created":"2016-08-17T16:11:13Z","modified":"2016-08-17T16:11:14Z","name":"mit-temp-test-32-137","note":"","default_template":False,"domain_id":"default","creating_user_id":"91d12adc-08d2-47f5-92e3-f82eb55e2028"}]}
sample_tempate_1 = {'countermeasures': {'app_countermeasures': {'http': 'default_per_source', 'dns': '', 'ssl_l4': 'default_per_source_ssl'}, 'dst_rates': {'udp_deny': '', 'other': 104, 'icmp_deny': False, 'tcp_deny': '', 'templatev6': '', 'icmp': 103, 'udp': 102, 'other_deny': '', 'tcp': 101, 'template': 'default_icmp'}, 'src_policy': {'udp_deny': False, 'other': '', 'icmp_deny': False, 'tcp_deny': False, 'classlists': [], 'icmp': '', 'udp': 104, 'other_deny': False, 'tcp': 104}, 'port_countermeasures': {'port_ranges': [], 'ports': [{'protocol': 'http', 'port_num': 80, 'glid': '', 'template': {'udp': '', 'http': 'default_http_1', 'dns': '', 'tcp': 'default_tcp_1', 'ssl_l4': ''}}, {'protocol': 'dns-udp', 'port_num': 53, 'glid': '', 'template': {'udp': 'default_udp_1', 'http': '', 'dns': 'default_dns_1', 'tcp': '', 'ssl_l4': ''}}, {'protocol': 'ssl-l4', 'port_num': 443, 'glid': '', 'template': {'udp': '', 'http': '', 'dns': '', 'tcp': 'default_tcp_1', 'ssl_l4': 'default_ssl'}}]}, 'ip_proto': {'ports': [{'port_num': 4, 'glid': '', 'template': {'other': ''}}, {'port_num': 51, 'glid': '', 'template': {'other': ''}}, {'port_num': 47, 'glid': '', 'template': {'other': ''}}, {'port_num': 41, 'glid': '', 'template': {'other': ''}}, {'port_num': 5, 'glid': '', 'template': {'other': ''}}, {'port_num': 50, 'glid': '', 'template': {'other': ''}}]}, 'port_wildcards_check': {'udp': 'disable', 'tcp': 'disable'}, 'src_auth': {'udp': '', 'other': '', 'tcp': ''}}, 'note': '', 'domain_id': 'default', 'name': 'customer-1-mit-temp-1', 'created': '2016-08-09T22:42:40Z', 'url': 'https://172.30.60.21/agapi/v1/ddos/template/mitigation/59a87d3c-3dc8-4ad3-9345-deec42988533/?format=json', 'creating_user_id': '91d12adc-08d2-47f5-92e3-f82eb55e2028', 'id': '59a87d3c-3dc8-4ad3-9345-deec42988533', 'default_template': False, 'modified': '2016-08-17T16:09:07Z'}


#for each_mit_temp in mitigation_template_list_1["mitigation_template_list"]:
